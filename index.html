<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì‚¼ì²œë¦¬ ì‚¬ë³´ ë§ì¶¤ ì¶”ì²œ ì„¤ë¬¸</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Malgun Gothic', sans-serif;
            background: white;
            padding: 20px;
        }

        .container {
            max-width: 800px;
            width: 100%;
            margin: 0 auto;
        }

        .progress-bar {
            width: 100%;
            height: 10px;
            background: #e0e0e0;
            border-radius: 10px;
            margin-bottom: 30px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
            width: 0%;
            transition: width 0.3s ease;
            border-radius: 10px;
        }

        .question-container {
            display: none;
        }

        .question-container.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes swing {
            0%, 100% {
                transform: rotate(-5deg);
            }
            50% {
                transform: rotate(5deg);
            }
        }

        .character-container {
            text-align: center;
            margin-bottom: 30px;
        }

        .character {
            width: 150px;
            height: auto;
            animation: swing 2s ease-in-out infinite;
            transform-origin: bottom center;
        }

        h1 {
            color: #333;
            font-size: 32px;
            margin-bottom: 15px;
            text-align: center;
        }

        .intro-text {
            text-align: center;
            color: #666;
            margin-bottom: 40px;
            line-height: 1.8;
            font-size: 16px;
        }

        .question-number {
            color: #667eea;
            font-weight: bold;
            font-size: 16px;
            margin-bottom: 15px;
        }

        .question-text {
            color: #333;
            font-size: 26px;
            font-weight: 600;
            margin-bottom: 35px;
            line-height: 1.4;
        }

        .options {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .option-btn {
            background: #f8f9fa;
            border: 3px solid #e0e0e0;
            border-radius: 15px;
            padding: 25px 30px;
            font-size: 18px;
            color: #333;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: left;
            position: relative;
            overflow: hidden;
        }

        .option-btn:before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(102, 126, 234, 0.1), transparent);
            transition: left 0.5s ease;
        }

        .option-btn:hover {
            border-color: #667eea;
            background: #f0f3ff;
            transform: translateX(5px);
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.2);
        }

        .option-btn:hover:before {
            left: 100%;
        }

        .start-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 15px;
            padding: 20px 50px;
            font-size: 20px;
            font-weight: 600;
            cursor: pointer;
            width: 100%;
            max-width: 400px;
            margin: 30px auto 0;
            display: block;
            transition: all 0.3s ease;
        }

        .start-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(102, 126, 234, 0.4);
        }

        .result-container {
            display: none;
            text-align: center;
        }

        .result-container.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }

        .result-title {
            color: #333;
            font-size: 28px;
            font-weight: bold;
            margin-bottom: 40px;
        }

        .recommendation {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 25px;
            text-align: left;
            border-left: 6px solid #667eea;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: block;
            color: inherit;
        }

        .recommendation:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 20px rgba(102, 126, 234, 0.3);
        }

        .recommendation:last-of-type {
            border-left-color: #764ba2;
        }

        .recommendation h3 {
            color: #667eea;
            font-size: 24px;
            margin-bottom: 15px;
        }

        .recommendation:last-of-type h3 {
            color: #764ba2;
        }

        .recommendation p {
            color: #666;
            line-height: 1.8;
            font-size: 16px;
            margin-bottom: 10px;
        }

        .recommendation .read-more {
            color: #667eea;
            font-weight: bold;
            font-size: 14px;
            margin-top: 15px;
        }

        .recommendation:last-of-type .read-more {
            color: #764ba2;
        }

        .emoji {
            font-size: 60px;
            margin-bottom: 20px;
        }

        .restart-btn {
            background: white;
            color: #667eea;
            border: 3px solid #667eea;
            border-radius: 15px;
            padding: 18px 40px;
            font-size: 18px;
            font-weight: 600;
            cursor: pointer;
            margin-top: 30px;
            transition: all 0.3s ease;
        }

        .restart-btn:hover {
            background: #667eea;
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);
        }

        /* ë‹¹ì²¨ í™”ë©´ ìŠ¤íƒ€ì¼ */
        .winner-container {
            display: none;
            text-align: center;
        }

        .winner-container.active {
            display: block;
            animation: fadeIn 0.5s ease, celebration 1s ease;
        }

        @keyframes celebration {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        .winner-box {
            background: linear-gradient(135deg, #ff9a56 0%, #ff6a00 100%);
            border-radius: 30px;
            padding: 50px 40px;
            box-shadow: 0 20px 60px rgba(255, 106, 0, 0.3);
            position: relative;
            overflow: hidden;
        }

        .winner-box:before {
            content: 'ğŸ‰';
            position: absolute;
            font-size: 100px;
            opacity: 0.1;
            top: -20px;
            left: -20px;
            animation: float 3s ease-in-out infinite;
        }

        .winner-box:after {
            content: 'â˜•';
            position: absolute;
            font-size: 100px;
            opacity: 0.1;
            bottom: -20px;
            right: -20px;
            animation: float 3s ease-in-out infinite reverse;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-20px); }
        }

        .winner-title {
            color: white;
            font-size: 48px;
            font-weight: bold;
            margin-bottom: 20px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
        }

        .winner-emoji {
            font-size: 80px;
            margin: 20px 0;
            animation: pulse 1.5s ease-in-out infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.2); }
        }

        .winner-message {
            color: white;
            font-size: 24px;
            line-height: 1.8;
            margin-bottom: 15px;
            font-weight: 500;
        }

        .winner-subtitle {
            color: rgba(255, 255, 255, 0.9);
            font-size: 18px;
            margin-bottom: 40px;
        }

        .winner-form {
            background: white;
            border-radius: 20px;
            padding: 35px;
            margin-top: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        }

        .winner-form h3 {
            color: #ff6a00;
            font-size: 20px;
            margin-bottom: 25px;
        }

        .form-group {
            margin-bottom: 20px;
            text-align: left;
        }

        .form-group label {
            display: block;
            color: #333;
            font-weight: 600;
            margin-bottom: 8px;
            font-size: 15px;
        }

        .form-group input {
            width: 100%;
            padding: 15px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            font-size: 16px;
            transition: all 0.3s ease;
        }

        .form-group input:focus {
            outline: none;
            border-color: #ff6a00;
            box-shadow: 0 0 0 3px rgba(255, 106, 0, 0.1);
        }

        .submit-btn {
            background: linear-gradient(135deg, #ff9a56 0%, #ff6a00 100%);
            color: white;
            border: none;
            border-radius: 12px;
            padding: 18px 40px;
            font-size: 18px;
            font-weight: 600;
            cursor: pointer;
            width: 100%;
            margin-top: 10px;
            transition: all 0.3s ease;
        }

        .submit-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(255, 106, 0, 0.4);
        }

        .submit-btn:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
        }

        /* ë°˜ì‘í˜• */
        @media (max-width: 768px) {
            body {
                padding: 15px;
            }

            h1 {
                font-size: 26px;
            }

            .question-text {
                font-size: 22px;
            }

            .option-btn {
                padding: 20px;
                font-size: 16px;
            }

            .recommendation h3 {
                font-size: 20px;
            }

            .character {
                width: 120px;
            }

            .winner-title {
                font-size: 36px;
            }

            .winner-message {
                font-size: 20px;
            }

            .winner-emoji {
                font-size: 60px;
            }

            .winner-box {
                padding: 40px 25px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="progress-bar">
            <div class="progress-fill" id="progressFill"></div>
        </div>

        <!-- ì‹œì‘ í™”ë©´ -->
        <div class="question-container active" id="intro">
            <div class="character-container">
                <img src="character.jpg" alt="ì‚¼ì²œë¦¬ ìºë¦­í„°" class="character">
            </div>
            <h1>ğŸ“° ë‹¹ì‹ ì„ ìœ„í•œ ì‚¼ì²œë¦¬ ì‚¬ë³´ ì¹¼ëŸ¼ì„ ì¶”ì²œí•´ ë“œë¦½ë‹ˆë‹¤!</h1>
            <p class="intro-text">
                ê°„ë‹¨í•œ ì§ˆë¬¸ì— ë‹µí•˜ì‹œë©´<br>
                ë‹¹ì‹ ì—ê²Œ ë”± ë§ëŠ” ì‚¬ë³´ ì¹¼ëŸ¼ì„ ì¶”ì²œí•´ë“œë¦½ë‹ˆë‹¤!
            </p>
            <button class="start-btn" onclick="startSurvey()">ì‹œì‘í•˜ê¸°</button>
        </div>

        <!-- ì§ˆë¬¸ 1 -->
        <div class="question-container" id="q1">
            <div class="question-number">ì§ˆë¬¸ 1/6</div>
            <div class="question-text">ì•„ì¹¨ì— ì¶œê·¼í•˜ë©´ ê°€ì¥ ë¨¼ì € í•˜ëŠ” ì¼ì€?</div>
            <div class="options">
                <button class="option-btn" onclick="answer(1, 'A')">
                    ğŸ“° íšŒì‚¬ ë‰´ìŠ¤ í™•ì¸í•˜ê±°ë‚˜ ì˜¤ëŠ˜ í•  ì¼ ì •ë¦¬
                </button>
                <button class="option-btn" onclick="answer(1, 'B')">
                    â˜• ë™ë£Œë“¤ì˜ ì•ˆë¶€ ë¬»ê¸°
                </button>
            </div>
        </div>

        <!-- ì§ˆë¬¸ 2 -->
        <div class="question-container" id="q2">
            <div class="question-number">ì§ˆë¬¸ 2/6</div>
            <div class="question-text">ì ì‹¬ì‹œê°„, ë‹¹ì‹ ì˜ ìŠ¤íƒ€ì¼ì€?</div>
            <div class="options">
                <button class="option-btn" onclick="answer(2, 'A')">
                    ğŸ½ï¸ ìƒˆë¡œìš´ ë§›ì§‘ ì°¾ì•„ íƒë°©
                </button>
                <button class="option-btn" onclick="answer(2, 'B')">
                    ğŸ§ ë™ë£Œë“¤ê³¼ ìˆ˜ë‹¤ ë–¨ê¸°
                </button>
                <button class="option-btn" onclick="answer(2, 'C')">
                    ğŸ˜´ ë‚®ì ìë©° íœ´ì‹í•˜ê¸°
                </button>
            </div>
        </div>

        <!-- ì§ˆë¬¸ 3 -->
        <div class="question-container" id="q3">
            <div class="question-number">ì§ˆë¬¸ 3/6</div>
            <div class="question-text">ì£¼ë§ì„ ë³´ë‚´ëŠ” ë‹¹ì‹ ì˜ ë°©ì‹ì€?</div>
            <div class="options">
                <button class="option-btn" onclick="answer(3, 'A')">
                    ğŸš— ë“œë¼ì´ë¸Œë‚˜ ì—¬í–‰ ë– ë‚˜ê¸°
                </button>
                <button class="option-btn" onclick="answer(3, 'B')">
                    ğŸ  ì§‘ì—ì„œ í˜¼ì ë˜ëŠ” ê°€ì¡±ê³¼ í•¨ê»˜ íœ´ì‹í•˜ë©° ì·¨ë¯¸ìƒí™œ
                </button>
            </div>
        </div>

        <!-- ì§ˆë¬¸ 4 -->
        <div class="question-container" id="q4">
            <div class="question-number">ì§ˆë¬¸ 4/6</div>
            <div class="question-text">SNSì— ì˜¬ë¦¬ê³  ì‹¶ì€ ìˆœê°„ì€?</div>
            <div class="options">
                <button class="option-btn" onclick="answer(4, 'A')">
                    ğŸ“¸ ë©‹ì§„ í’ê²½ì´ë‚˜ íŠ¹ë³„í•œ ì¥ë©´
                </button>
                <button class="option-btn" onclick="answer(4, 'B')">
                    ğŸ½ï¸ ë§›ìˆëŠ” ìŒì‹ ë°œê²¬
                </button>
                <button class="option-btn" onclick="answer(4, 'C')">
                    ğŸ‘¨â€ğŸ‘©â€ğŸ‘§ ê°€ì¡±ì´ë‚˜ ì¹œêµ¬ì™€ì˜ íŠ¹ë³„í•œ ìˆœê°„
                </button>
            </div>
        </div>

        <!-- ì§ˆë¬¸ 5 -->
        <div class="question-container" id="q5">
            <div class="question-number">ì§ˆë¬¸ 5/6</div>
            <div class="question-text">íšŒì‚¬ì—ì„œ ê¶ê¸ˆí•œ ê²ƒì€?</div>
            <div class="options">
                <button class="option-btn" onclick="answer(5, 'A')">
                    ğŸ‘¥ ë‹¤ë¥¸ ë¶€ì„œëŠ” ì–´ë–¤ ì¼ì„ í•˜ëŠ”ì§€
                </button>
                <button class="option-btn" onclick="answer(5, 'B')">
                    ğŸ†• íšŒì‚¬ ë‚´ êµ¬ì„±ì›ë“¤ ì†Œê°œ
                </button>
                <button class="option-btn" onclick="answer(5, 'C')">
                    ğŸ‘¨â€ğŸ‘©â€ğŸ‘§ ë™ë£Œ ì§ì›ë“¤ì˜ ì·¨ë¯¸ë‚˜ ì†Œì†Œí•œ ì¼ìƒ
                </button>
            </div>
        </div>

        <!-- ì§ˆë¬¸ 6 -->
        <div class="question-container" id="q6">
            <div class="question-number">ì§ˆë¬¸ 6/6</div>
            <div class="question-text">ì¶œí‡´ê·¼ê¸¸ì— ì£¼ë¡œ í•˜ëŠ” ì¼ì€?</div>
            <div class="options">
                <button class="option-btn" onclick="answer(6, 'A')">
                    ğŸ“Š ë‰´ìŠ¤ë‚˜ íšŒì‚¬ ì†Œì‹ í™•ì¸
                </button>
                <button class="option-btn" onclick="answer(6, 'B')">
                    ğŸ¨ ì—¬í–‰Â·ì·¨ë¯¸ ì½˜í…ì¸  ë‘˜ëŸ¬ë³´ê¸°
                </button>
                <button class="option-btn" onclick="answer(6, 'C')">
                    ğŸ’¡ ìœ ìš©í•œ ìƒí™œ ì •ë³´ ì°¾ì•„ë³´ê¸°
                </button>
            </div>
        </div>

        <!-- ë‹¹ì²¨ í™”ë©´ -->
        <div class="winner-container" id="winner">
            <div class="winner-box">
                <div class="winner-title">ğŸ‰ ì¶•! ë‹¹ì²¨!! ğŸ‰</div>
                <div class="winner-emoji">â˜•</div>
                <div class="winner-message">
                    ë”°ìŠ¤í•œ ê²¨ìš¸.<br>
                    ì•„ë©”ë¦¬ì¹´ë…¸ ë§ˆì‹œê³  ê°€ì‹¤ê²Œìš”
                </div>
                <div class="winner-subtitle">(ì»¤í”¼ì¿ í° ì¦ì •)</div>

                <div class="winner-form">
                    <h3>â„ï¸ ê²½í’ˆ ìˆ˜ë ¹ì„ ìœ„í•´ ì •ë³´ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš” â­</h3>
                    <form id="winnerForm" onsubmit="submitWinnerInfo(event)">
                        <div class="form-group">
                            <label>ì†Œì†</label>
                            <input type="text" id="department" required placeholder="ì˜ˆ: ì´ë¬´íŒ€">
                        </div>
                        <div class="form-group">
                            <label>ì´ë¦„</label>
                            <input type="text" id="name" required placeholder="ì˜ˆ: í™ê¸¸ë™">
                        </div>
                        <div class="form-group">
                            <label>ì´ë©”ì¼</label>
                            <input type="email" id="email" required placeholder="ì˜ˆ: hong@samchully.co.kr">
                        </div>
                        <button type="submit" class="submit-btn" id="submitBtn">ì œì¶œí•˜ê¸°</button>
                    </form>
                </div>
            </div>
        </div>

        <!-- ê²°ê³¼ í™”ë©´ -->
        <div class="result-container" id="result">
            <div class="emoji">ğŸ‰</div>
            <h1 class="result-title">ë‹¹ì‹ ì„ ìœ„í•œ ì¶”ì²œ ì¹¼ëŸ¼</h1>
            <div id="recommendations"></div>
            <button class="restart-btn" onclick="restart()">ë‹¤ì‹œ í•˜ê¸°</button>
        </div>
    </div>

    <script>
        // Google Apps Script ë°°í¬ URL
        const GOOGLE_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycby_gjWhPIat4awOMlZzoxxXsr000fphyzfEDaccD4RKxbRVyi7dEgxja6pvxMGKDMbE3w/exec';

        // âš ï¸ í…ŒìŠ¤íŠ¸ìš©: 100% ë‹¹ì²¨ í™•ë¥  (ì‹¤ì œ ë°°í¬ ì‹œ 0.01ë¡œ ë³€ê²½!)
        const WINNING_PROBABILITY = 1.0; // í…ŒìŠ¤íŠ¸: 100%, ì‹¤ì œ: 0.01 (1%)

        let answers = {};
        let currentQuestion = 0;
        let sessionId = '';
        let isWinner = false;
        let recommendations = [];
        const totalQuestions = 6;

        const columns = {
            hotissue: {
                title: 'ğŸ† í•«ì´ìŠˆ',
                description: 'ì‚¼ì²œë¦¬, 2026ë…„ í•œêµ­ì—ì„œ ê°€ì¥ ì¡´ê²½ë°›ëŠ” ê¸°ì—… ë„ì‹œê°€ìŠ¤ ë¶€ë¬¸ 1ìœ„! 23ë…„ ì—°ì† ì„ ì •ì˜ ì˜ì˜ˆë¥¼ í•¨ê»˜ í™•ì¸í•´ë³´ì„¸ìš”.',
                url: 'http://sabo.samchully.co.kr/202602/special06.php'
            },
            newhire: {
                title: 'ğŸŒŸ 2026 ì‚¼ì²œë¦¬ ì‹ ì…ì‚¬ì› ì…ë¬¸êµìœ¡',
                description: 'ìƒˆë¡­ê²Œ ì‚¼ì²œë¦¬ ê°€ì¡±ì´ ëœ 2026ë…„ ì‹ ì…ì‚¬ì›ë“¤ì˜ ì…ë¬¸êµìœ¡ í˜„ì¥ê³¼ ì—´ì • ê°€ë“í•œ ì²«ê±¸ìŒì„ ë§Œë‚˜ë³´ì„¸ìš”.',
                url: 'http://sabo.samchully.co.kr/202602/special02.php'
            },
            safety: {
                title: 'ğŸ’¡ ìƒí™œì•ˆì „ì´ì•¼ê¸°',
                description: 'ê²¨ìš¸ì²  ì‹¤ë‚´ í™˜ê¸°ì˜ ì¤‘ìš”ì„±! ê±´ê°•í•˜ê³  ì•ˆì „í•œ ìƒí™œì„ ìœ„í•œ ì‹¤ìš©ì ì¸ íŒì„ ì•Œë ¤ë“œë¦½ë‹ˆë‹¤.',
                url: 'https://sabo.samchully.co.kr/202602/special01.php'
            },
            dreamteam: {
                title: 'ğŸ¢ ìš°ë¦¬ëŠ” ë“œë¦¼íŒ€',
                description: 'ì‚¼ì²œë¦¬ F/Cê°œë°œíŒ€ì˜ ìƒìƒí•œ ì´ì•¼ê¸°! ê° ë¶€ì„œì˜ ì—…ë¬´ì™€ ë¶„ìœ„ê¸°, ê·¸ë¦¬ê³  í•¨ê»˜ ì¼í•˜ëŠ” ì‚¬ëŒë“¤ì˜ ì§„ì†”í•œ ê²½í—˜ë‹´ì„ ë§Œë‚˜ë³´ì„¸ìš”.',
                url: 'http://sabo.samchully.co.kr/202602/people01.php'
            },
            inside: {
                title: 'ğŸ’­ ì‚¼ì²œë¦¬äººSIDE',
                description: 'ì‚¼ì²œë¦¬ê·¸ë£¹ ì„ì§ì›ë“¤ì´ ìš”ì¦˜ ëŠë¼ëŠ” ê°ì •ì€? ë™ë£Œë“¤ì˜ ì†”ì§í•œ ë§ˆìŒê³¼ ì¼ìƒ ì† ì§„ì†”í•œ ì´ì•¼ê¸°ë¥¼ ê³µìœ í•©ë‹ˆë‹¤.',
                url: 'http://sabo.samchully.co.kr/202602/people04.php'
            },
            photo: {
                title: 'ğŸ“¸ ì‚¼ì²œë¦¬ ì§ì›ì´ ì“´ ì‚¬ì§„ì´¬ì˜ ë…¸í•˜ìš°',
                description: 'ì—¬í–‰ê³¼ ì¼ìƒì„ ë”ìš± íŠ¹ë³„í•˜ê²Œ! ì‚¼ì²œë¦¬ ì§ì›ì´ ì§ì ‘ ì•Œë ¤ì£¼ëŠ” ì‚¬ì§„ ì´¬ì˜ ê¿€íŒê³¼ ë…¸í•˜ìš°ë¥¼ ë°°ì›Œë³´ì„¸ìš”.',
                url: 'http://sabo.samchully.co.kr/202602/people05.php'
            },
            family: {
                title: 'ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦ ê°€ì¡±ì€ ë‚˜ì˜í˜',
                description: 'ì‚¼ì²œë¦¬ê·¸ë£¹ ê°€ì¡±ë“¤ì˜ ì·¨ë¯¸ë°•ìŠ¤ ì±Œë¦°ì§€! ë™ë£Œë“¤ì˜ ë”°ëœ»í•œ ê°€ì¡± ì´ì•¼ê¸°ì™€ ì¼ìƒ ì† ì†Œì†Œí•œ í–‰ë³µì„ í•¨ê»˜ ë‚˜ëˆ ìš”.',
                url: 'http://sabo.samchully.co.kr/202602/people09.php'
            },
            travel: {
                title: 'ğŸš— ì‚¼ì²œë¦¬ ë°©ë°©ê³¡ê³¡',
                description: 'BMW i5 M60 Proì™€ í•¨ê»˜ ë– ë‚˜ëŠ” ê´‘ëª…ë™êµ´ ì—¬í–‰! ì£¼ë§ ë“œë¼ì´ë¸Œ ì½”ìŠ¤ë¡œ ì™„ë²½í•œ íŠ¹ë³„í•œ ì—¬í–‰ ì´ì•¼ê¸°ë¥¼ ë§Œë‚˜ë³´ì„¸ìš”.',
                url: 'http://sabo.samchully.co.kr/202602/life01.php'
            },
            food: {
                title: 'ğŸ´ ìŠ¤í˜ì…œí‘¸ë“œ',
                description: 'ì‚´ë¡±ë“œ í˜¸ìš°ì„¬ ë„ê³¡ì ! ì ì‹¬ ë©”ë‰´ ê³ ë¯¼ì€ ì´ì œ ê·¸ë§Œ, ë™ë£Œë“¤ì´ ì§ì ‘ ë‹¤ë…€ì˜¨ ë§›ì§‘ ë¦¬ë·°ë¥¼ í™•ì¸í•´ë³´ì„¸ìš”.',
                url: 'http://sabo.samchully.co.kr/202602/life02.php'
            },
            news: {
                title: 'ğŸ“° ì‚¼ì²œë¦¬ê·¸ë£¹ ì£¼ìš” ë‰´ìŠ¤',
                description: 'ì‚¼ì²œë¦¬ê·¸ë£¹ì˜ ìµœì‹  ì†Œì‹ê³¼ ì£¼ìš” ì„±ê³¼ë¥¼ í•œëˆˆì—! ìš°ë¦¬ íšŒì‚¬ì˜ ë°œì „ê³¼ ë³€í™”ë¥¼ í•¨ê»˜ í™•ì¸í•˜ì„¸ìš”.',
                url: 'http://sabo.samchully.co.kr/202602/life05.php'
            }
        };

        // ì„¸ì…˜ ID ìƒì„±
        function generateSessionId() {
            return 'session_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
        }

        function startSurvey() {
            sessionId = generateSessionId();
            document.getElementById('intro').classList.remove('active');
            document.getElementById('q1').classList.add('active');
            currentQuestion = 1;
            updateProgress();
        }

        function answer(questionNum, choice) {
            answers[`q${questionNum}`] = choice;
            
            const current = document.getElementById(`q${questionNum}`);
            current.classList.remove('active');
            
            if (questionNum < totalQuestions) {
                currentQuestion = questionNum + 1;
                document.getElementById(`q${questionNum + 1}`).classList.add('active');
                updateProgress();
            } else {
                // ë§ˆì§€ë§‰ ì§ˆë¬¸ ì™„ë£Œ í›„ ë‹¹ì²¨ ì¶”ì²¨
                checkWinner();
            }
        }

        function updateProgress() {
            const progress = (currentQuestion / totalQuestions) * 100;
            document.getElementById('progressFill').style.width = progress + '%';
        }

        function calculateResult() {
            const scores = {
                hotissue: 0,
                newhire: 0,
                safety: 0,
                dreamteam: 0,
                inside: 0,
                photo: 0,
                family: 0,
                travel: 0,
                food: 0,
                news: 0
            };

            if (answers.q1 === 'A') {
                scores.hotissue += 2;
                scores.news += 2;
            } else {
                scores.dreamteam += 2;
                scores.inside += 1;
            }

            if (answers.q2 === 'A') {
                scores.food += 2;
            } else if (answers.q2 === 'B') {
                scores.dreamteam += 1;
                scores.inside += 2;
            } else if (answers.q2 === 'C') {
                scores.family += 2;
            }

            if (answers.q3 === 'A') {
                scores.travel += 2;
                scores.photo += 2;
            } else {
                scores.family += 2;
            }

            if (answers.q4 === 'A') {
                scores.photo += 2;
                scores.travel += 1;
            } else if (answers.q4 === 'B') {
                scores.food += 2;
            } else {
                scores.family += 2;
            }

            if (answers.q5 === 'A') {
                scores.dreamteam += 2;
            } else if (answers.q5 === 'B') {
                scores.newhire += 2;
                scores.inside += 2;
            } else {
                scores.family += 1;
                scores.inside += 2;
            }

            if (answers.q6 === 'A') {
                scores.hotissue += 2;
                scores.news += 2;
            } else if (answers.q6 === 'B') {
                scores.photo += 1;
                scores.travel += 2;
            } else {
                scores.safety += 2;
            }

            const sorted = Object.entries(scores)
                .sort((a, b) => b[1] - a[1])
                .slice(0, 2);

            return sorted.map(item => item[0]);
        }

        // ë‹¹ì²¨ ì—¬ë¶€ í™•ì¸
        function checkWinner() {
            recommendations = calculateResult();
            
            // ëœë¤ ì¶”ì²¨
            isWinner = Math.random() < WINNING_PROBABILITY;
            
            // Google Sheetsì— ì„¤ë¬¸ ê²°ê³¼ ì „ì†¡
            sendSurveyToGoogleSheets(recommendations, isWinner);
            
            if (isWinner) {
                // ë‹¹ì²¨ í™”ë©´ í‘œì‹œ
                showWinnerScreen();
            } else {
                // ì¼ë°˜ ê²°ê³¼ í™”ë©´ í‘œì‹œ
                showResult();
            }
        }

        // ë‹¹ì²¨ í™”ë©´ í‘œì‹œ
        function showWinnerScreen() {
            document.getElementById('winner').classList.add('active');
            document.getElementById('progressFill').style.width = '100%';
        }

        // ë‹¹ì²¨ì ì •ë³´ ì œì¶œ
        async function submitWinnerInfo(event) {
            event.preventDefault();
            
            const submitBtn = document.getElementById('submitBtn');
            submitBtn.disabled = true;
            submitBtn.textContent = 'ì œì¶œ ì¤‘...';
            
            const department = document.getElementById('department').value;
            const name = document.getElementById('name').value;
            const email = document.getElementById('email').value;
            
            // Google Sheetsì— ë‹¹ì²¨ì ì •ë³´ ì „ì†¡
            await sendWinnerToGoogleSheets(department, name, email);
            
            // ë‹¹ì²¨ í™”ë©´ ìˆ¨ê¸°ê³  ê²°ê³¼ í™”ë©´ í‘œì‹œ
            document.getElementById('winner').classList.remove('active');
            showResult();
        }

        // Google Sheetsì— ì„¤ë¬¸ ë°ì´í„° ì „ì†¡
        async function sendSurveyToGoogleSheets(recommendations, isWinner) {
            if (GOOGLE_SCRIPT_URL === 'YOUR_GOOGLE_SCRIPT_URL_HERE') {
                console.log('Google Script URLì´ ì„¤ì •ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.');
                return;
            }

            const data = {
                type: 'survey',
                sessionId: sessionId,
                q1: answers.q1,
                q2: answers.q2,
                q3: answers.q3,
                q4: answers.q4,
                q5: answers.q5,
                q6: answers.q6,
                result1: recommendations[0],
                result2: recommendations[1],
                isWinner: isWinner ? 'â­ë‹¹ì²¨' : ''
            };

            try {
                await fetch(GOOGLE_SCRIPT_URL, {
                    method: 'POST',
                    mode: 'no-cors',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(data)
                });
                console.log('ì„¤ë¬¸ ë°ì´í„° ì „ì†¡ ì™„ë£Œ');
            } catch (error) {
                console.error('ì„¤ë¬¸ ë°ì´í„° ì „ì†¡ ì‹¤íŒ¨:', error);
            }
        }

        // Google Sheetsì— ë‹¹ì²¨ì ì •ë³´ ì „ì†¡
        async function sendWinnerToGoogleSheets(department, name, email) {
            if (GOOGLE_SCRIPT_URL === 'YOUR_GOOGLE_SCRIPT_URL_HERE') {
                console.log('Google Script URLì´ ì„¤ì •ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.');
                return;
            }

            const data = {
                type: 'winner',
                sessionId: sessionId,
                department: department,
                name: name,
                email: email
            };

            try {
                await fetch(GOOGLE_SCRIPT_URL, {
                    method: 'POST',
                    mode: 'no-cors',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(data)
                });
                console.log('ë‹¹ì²¨ì ì •ë³´ ì „ì†¡ ì™„ë£Œ');
            } catch (error) {
                console.error('ë‹¹ì²¨ì ì •ë³´ ì „ì†¡ ì‹¤íŒ¨:', error);
            }
        }

        // Google Sheetsì— í´ë¦­ ë°ì´í„° ì „ì†¡
        async function sendClickToGoogleSheets(columnKey, columnTitle) {
            if (GOOGLE_SCRIPT_URL === 'YOUR_GOOGLE_SCRIPT_URL_HERE') {
                console.log('Google Script URLì´ ì„¤ì •ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.');
                return;
            }

            const data = {
                type: 'click',
                sessionId: sessionId,
                columnKey: columnKey,
                columnTitle: columnTitle
            };

            try {
                await fetch(GOOGLE_SCRIPT_URL, {
                    method: 'POST',
                    mode: 'no-cors',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(data)
                });
                console.log('í´ë¦­ ë°ì´í„° ì „ì†¡ ì™„ë£Œ:', columnTitle);
            } catch (error) {
                console.error('í´ë¦­ ë°ì´í„° ì „ì†¡ ì‹¤íŒ¨:', error);
            }
        }

        // ì¹¼ëŸ¼ í´ë¦­ í•¸ë“¤ëŸ¬
        function handleColumnClick(columnKey) {
            const column = columns[columnKey];
            sendClickToGoogleSheets(columnKey, column.title);
        }

        // ì¼ë°˜ ê²°ê³¼ í™”ë©´ í‘œì‹œ
        function showResult() {
            const resultHTML = recommendations.map(colKey => {
                const col = columns[colKey];
                return `
                    <a href="${col.url}" 
                       target="_blank" 
                       class="recommendation"
                       onclick="handleColumnClick('${colKey}')">
                        <h3>${col.title}</h3>
                        <p>${col.description}</p>
                        <div class="read-more">ğŸ‘‰ ì§€ê¸ˆ ë°”ë¡œ ì½ì–´ë³´ê¸°</div>
                    </a>
                `;
            }).join('');

            document.getElementById('recommendations').innerHTML = resultHTML;
            document.getElementById('result').classList.add('active');
            document.getElementById('progressFill').style.width = '100%';
        }

        function restart() {
            answers = {};
            currentQuestion = 0;
            sessionId = '';
            isWinner = false;
            recommendations = [];
            document.getElementById('result').classList.remove('active');
            document.getElementById('winner').classList.remove('active');
            document.getElementById('intro').classList.add('active');
            document.getElementById('progressFill').style.width = '0%';
            
            // ë‹¹ì²¨ì í¼ ì´ˆê¸°í™”
            document.getElementById('winnerForm').reset();
            document.getElementById('submitBtn').disabled = false;
            document.getElementById('submitBtn').textContent = 'ì œì¶œí•˜ê¸°';
            
            for (let i = 1; i <= totalQuestions; i++) {
                document.getElementById(`q${i}`).classList.remove('active');
            }
        }
    </script>
</body>
</html>
